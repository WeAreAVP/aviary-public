(this.webpackJsonpaviary_transcript=this.webpackJsonpaviary_transcript||[]).push([[0],{114:function(e,t,a){e.exports=a(212)},119:function(e,t,a){},121:function(e,t,a){},212:function(e,t,a){"use strict";a.r(t),a.d(t,"SlateTranscriptEditor",(function(){return Qe})),a.d(t,"secondsToTimecode",(function(){return W})),a.d(t,"timecodeToSeconds",(function(){return J})),a.d(t,"shortTimecode",(function(){return q})),a.d(t,"convertDpeToSlate",(function(){return ae})),a.d(t,"converSlateToDpe",(function(){return pe})),a.d(t,"slateToText",(function(){return le}));var n=a(0),r=a.n(n),i=a(18),o=a.n(i),s=(a(119),a(10)),c=a.n(s),l=a(20),u=a(39),d=a(56),p=a(45),m=a(71),f=a(72),h=(a(121),a(97)),v=a.n(h),g=(a(133),a(75)),b=(a(150),a(98)),y=function(e){Object(f.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).handleBeforeUnload=function(e){if(!n.state.isTranscriptDataSaved)return e.preventDefault(),e.returnValue="",""},n.loadTranscript=function(e){try{fetch(atob(e.transcript)).then((function(e){return e.json()})).then((function(t){var a=t.media_url;t.env||(a=t.host+t.media_url);var r=t.transcript;"ibm"!==t.sst_type&&"slatejs"!==t.sst_type||(r=JSON.parse(r)),n.setState({transcriptData:r,mediaUrl:a,title:t.title,sttType:t.sst_type,isLoaded:!0,aviaryUrl:atob(e.transcript),resourceTitle:t.resource_title,metadata:t.metadata})}),(function(e){n.setState({isLoaded:!0,error:!0})}))}catch(t){n.setState({isLoaded:!0,error:!0})}},n.save=function(e,t){n.saveTranscript(e,!1,t)},n.saveAndClose=function(e,t){n.saveTranscript(e,!0,t)},n.saveTranscriptTitle=function(e){n.setState({title:e})},n.saveMetadata=function(){var e=Object(l.a)(c.a.mark((function e(t){var a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({formEdit:!1}),a={file_transcript:{is_edit:!1,is_caption:t.isCaption,is_public:t.isPublic,is_downloadable:t.isDownloadable,description:t.description,language:t.language}},r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},e.next=5,fetch(n.state.aviaryUrl+".json",r).then((function(e){return e.json()})).then((function(e){g.NotificationManager.success("","Transcript Metadata saved successfully.",3e3)}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.saveTranscript=function(){var e=Object(l.a)(c.a.mark((function e(t){var a,r,i,o,s,l=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>1&&void 0!==l[1]&&l[1],r=l.length>2?l[2]:void 0,n.setState({formEdit:!1,isTranscriptDataSaved:!0}),i={file_transcript:{slatejs:t,is_edit:!1,title:n.state.title,is_caption:r.isCaption,is_public:r.isPublic,is_downloadable:r.isDownloadable,description:r.description,language:r.language},speakers:["allison","watson"]},o=b.a.gzip(JSON.stringify(i),{to:"string"}),s={method:"POST",headers:{"Content-Encoding":"gzip"},body:o},e.next=9,fetch(n.state.aviaryUrl+".json",s).then((function(e){return e.json()})).then((function(e){g.NotificationManager.success("","Transcript saved successfully.",3e3),a&&window.close()}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.cancelEditRequest=Object(l.a)(c.a.mark((function e(){var t,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1,!0!==(!n.state.formEdit||window.confirm("Changes that you made may not be saved. Are you sure you want to cancel?"))){e.next=8;break}return n.setState({formEdit:!1}),t={file_transcript:{is_edit:!1}},a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},e.next=8,fetch(n.state.aviaryUrl+".json",a).then((function(e){return e.json()})).then((function(e){window.close()}));case 8:case"end":return e.stop()}}),e)}))),n.handleSetTranscriptDataSaved=function(e){n.setState({isTranscriptDataSaved:e})},n.state={transcriptData:null,mediaUrl:null,isTextEditable:!0,spellCheck:!0,sttType:null,analyticsEvents:[],title:"",resourceTitle:"",fileName:"",autoSaveData:{},autoSaveContentType:"slate",autoSaveExtension:"json",isLoaded:!1,error:!1,aviaryUrl:"",formEdit:!1,metadata:{},isTranscriptDataSaved:!0},n.editorRef=r.a.createRef(),n.cancelEditRequest=n.cancelEditRequest.bind(Object(p.a)(n)),n.loadTranscript=n.loadTranscript.bind(Object(p.a)(n)),n.save=n.save.bind(Object(p.a)(n)),n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=v.a.parse(window.location.search);localStorage.setItem("transcript_finish",!1),"undefined"!=typeof e.transcript?this.loadTranscript(e):this.setState({isLoaded:!0,error:!0}),document.addEventListener("contextmenu",(function(e){return e.preventDefault()})),window.addEventListener("unload",function(){var e=Object(l.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.setItem("transcript_finish",!0);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),window.addEventListener("beforeunload",this.handleBeforeUnload)}},{key:"componentDidUpdate",value:function(){this.state.formEdit?window.onbeforeunload=function(){return!0}:window.onbeforeunload=void 0}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.handleBeforeUnload)}},{key:"render",value:function(){return this.state.isLoaded&&!this.state.error?r.a.createElement("div",{className:"App"},r.a.createElement("section",{className:"ml-lg-3"},r.a.createElement(et,{mediaUrl:this.state.mediaUrl,transcriptData:this.state.transcriptData,handleSaveEditor:this.save,handleSaveAndClose:this.saveAndClose,handleSaveTranscriptTitle:this.saveTranscriptTitle,isEditable:this.state.isTextEditable,title:this.state.title,resourceTitle:this.state.resourceTitle,autoSaveContentType:"slate",showTitle:!0,mediaRef:this.editorRef,sttType:this.state.sttType,metadata:this.state.metadata,saveMetadata:this.saveMetadata,isTranscriptDataSaved:this.state.isTranscriptDataSaved,setTranscriptDataSaved:this.handleSetTranscriptDataSaved})),r.a.createElement(g.NotificationContainer,null)):this.state.isLoaded?r.a.createElement("div",null," Transcript does not exist or you don't have the permission to access it. "):r.a.createElement("div",{className:"loader-container"},r.a.createElement("div",{className:"loader"}),r.a.createElement("span",{className:"loader-text"},"Please wait while the transcript is being loaded..."))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var w=a(35),x=a(11),k=a(99),E=a(1),T=a(84),S=a.n(T),j=a(112),C=a(24),O=a(111),N=a(15),R=a(109),A=a(26),D=a(12),I=a(14),L=a(217),F=a(216),M=a(31),P=a(32),U=a(2),_=a(38),K=a(113),B=a(28),z=a(27),W=function(e,t){if(0===e)return"00:00:00:00";var a=25;void 0!==t&&(a=t);var n=function(e,t){return Number((1/t*Math.floor(Number((t*e).toPrecision(12)))).toFixed(2))}(e,a),r=Math.floor(n),i=((n-r)*a).toFixed(2);function o(e){return e<10?"0".concat(parseInt(e)):parseInt(e)}return"".concat(o(r/60/60%60),":").concat(o(r/60%60),":").concat(o(r%60),":").concat(o(i))},G=function(e,t){var a=25;void 0!==t&&(a=t);var n=function(e,t){var a=e.split(":"),n=parseInt(a[3]);return n+=parseInt(a[2])*t,n+=parseInt(a[1])*(60*t),n+=parseInt(a[0])*(60*t*60)}(e,a);return Number(Number(n/a).toFixed(2))},H=function(e){return 1===e.length},V=function(e){if("string"!==typeof e)return e;switch(e.split(":").length){case 4:return e;case 2:return H(e.split(":")[0])?"00:0".concat(e,":00"):"00:".concat(e,":00");case 3:return"".concat(e,":00");default:return function(e){return e.includes(".")}(e)?H(e.split(".")[0])?"00:0".concat(e.split(".")[0],":").concat(e.split(".")[1],":00"):"00:".concat(e.replace(".",":"),":00"):H(e)?"00:00:0".concat(e,":00"):"00:00:".concat(e,":00")}},J=function(e){if("string"===typeof e){var t=V(e);return G(t)}return parseFloat(e)},q=function(e){return 0===e?"00:00:00":W(e).slice(0,-3)},Y=function(e,t,a){var n=a||"application/octet-stream",r=document.createElement("a"),i=new Blob([e],{type:n});r.href=window.URL.createObjectURL(i),r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)};function Z(e,t,a){if(!Array.isArray(e))throw new TypeError("The first argument must be an array.");return e.filter((function(e){return e.to===a&&e.from===t}))[0]}function X(e,t){if(!Array.isArray(e))throw new TypeError("Expected result to be an array");return e.map((function(e){return e.alternatives.map((function(e){return e.timestamps.map((function(e){return function(e,t){if(!Array.isArray(e)||e.length<3)throw new TypeError("Expected IBMWord to be an array with at least three elements");var a=Object(E.a)(e,3),n=a[0],r=a[1],i=a[2];return{start:r,end:i,text:n,speaker:t?Z(t,r,i).speaker:null}}(e,t)}))}))}))}function $(e){var t=e.results,a=t[0].results||t,n=e.speaker_labels||e.results[0].speaker_labels,r=X(a,n=n&&n.length>0?n:null);Array.isArray(r[0][0])&&(r=r.flat());return{paragraphs:(n?function(e,t){if(!Array.isArray(e)||0===e.length)return[];var a=[];return e.forEach((function(e,n){var r=e.alternatives[0].timestamps[0][1],i=e.alternatives[0].timestamps[e.alternatives[0].timestamps.length-1][2],o=Z(t,r,e.alternatives[0].timestamps[0][2]).speaker;a.push({start:r,end:i,speaker:o})})),a}(a,n):function(e){if(!Array.isArray(e)||0===e.length)return[];var t=[];return e.forEach((function(e){var a=e.alternatives[0].timestamps[0][1],n=e.alternatives[0].timestamps[e.alternatives[0].timestamps.length-1][2];t.push({start:a,end:n,speaker:"Add speaker"})})),t}(a)).flat(),words:r.flat().flat()}}var Q=function(e,t){return t.filter((function(t){return t.start>=e.start&&t.end<=e.end})).map((function(e){return e.text})).join(" ")},ee=function(e){return(t=e[e.length-1].start)?Object(x.a)(Array(parseInt(t)).keys()):[0];var t},te=function(e,t){return a=ee(e),n=t,a.splice(0,n,0).join(" ");var a,n},ae=function(e,t){if(a=e,0===Object.keys(a).length)return[{speaker:"U_UKN",start:0,previousTimings:"0",startTimecode:"00:00:00",type:"timedText",children:[{text:"Text",words:[]}]}];var a,n={};if("ibm"===t)n=$(e);else if("vtt"===t)n=function(e){var t=e.split("\n"),a={paragraphs:[],words:[]};function n(e){var t=e.split(":").map(Number),a=Object(E.a)(t,3),n=a[0],r=a[1],i=a[2];return 3600*n+60*r+parseFloat(i)}return t.forEach((function(e,r){if(e.includes("--\x3e")){var i=e.match(/(\d{2}:\d{2}:\d{2}.\d{3}) --> (\d{2}:\d{2}:\d{2}.\d{3})/),o=i?n(i[1]):0,s=i?n(i[2]):0,c=null,l=null,u=/([A-Z0-9\s]+:)/;if(t[r+1]&&t[r+1].includes("<v"))c=t[r+1].match(/<v ([a-zA-Z0-9]+)>/),l=c?c[1]:"Add speaker";else if(t[r+1]&&t[r+1].match(u))c=t[r+1].match(u),l=c?c[1]:"Add speaker";else if(t[r+1]&&t[r+2]){var d=t[r+2],p=t[r+1];d.includes(":")?(c=d.match(u),l=c?p+" "+c[1]:"Add speaker"):(c=p.match(u),l=c?c[1]:"Add speaker")}else l="Add speaker";l=l.replace(":","");for(var m="",f=!1,h=1;t[r+h];h++){var v=t[r+h],g=t[r+h+1]||"";f||!g.includes(":")?!f&&v.includes(":")?(m+=v.split(":")[1].trim(),f=!0):m+=" "+v:!v.includes(":")&&g.includes(":")&&(m+=g.split(":")[1].trim(),f=!0,h+=1)}if(m=m.replace(/<[^>]*>/g,"").trim()){var b;a.paragraphs.push({start:o,end:s,speaker:l});var y=m&&m.split(" "),w=(s-o)/(y?y.length:1),k=y&&y.map((function(e,t){return{start:o+t*w,end:o+(t+1)*w,text:e,speaker:l}}));(b=a.words).push.apply(b,Object(x.a)(k||[]))}}})),a}(e);else if("plain"===t)n=function(e){var t=e.split(/\n|<br>/),a={paragraphs:[],words:[]},n=0,r=0,i=null,o=0,s=e.includes("TRANSCRIPTION BEGIN");return t.forEach((function(e,c){var l=/\[(?:[01]\d|2[0-3]):(?:[0-5]\d):(?:[0-5]\d)\]/g;(i=e.match(l))&&(o=i[0].replace("]","").replace("[",""),J(o)!==n&&(n=r));if(!s&&!l.test(e)){var u="Add speaker",d=e.match(/\b(?:\w+(?:-\w+)?(?:\s+\w+(?:-\w+)?)*):\s*/gi);d&&(u=d[0].replace(":","").trim());var p=e;if(d&&(p=p.replace(d[0],"")),p=p.trim()){var m,f,h,v=p&&p.split(" "),g=.5,b=null===(m=t[c+2])||void 0===m?void 0:m.match(l),y="",w=null;b&&(y=b[0].replace("]","").replace("[",""),w=J(y)),h=v.length*g+r,w===r&&(w=h),r=w||h,a.paragraphs.push({start:n,end:r,speaker:u}),g=(r-n)/v.length;var k=v&&v.map((function(e,t){return{start:n+t*g,end:n+(t+1)*g,text:e,speaker:u}}));n=r,(f=a.words).push.apply(f,Object(x.a)(k||[]))}}s&&(s=!e.includes("TRANSCRIPTION BEGIN"))})),a}(e);else{if("deepgram"!==t){if("slatejs"===t)return e;throw new Error("Invalid sttType")}n=function(e){var t=JSON.parse(e).results.channels[0].alternatives[0];return{paragraphs:t.paragraphs.paragraphs.map((function(e){return{start:e.start,end:e.end,speaker:e.speaker}})),words:t.words.map((function(e){return{start:e.start,end:e.end,text:e.punctuated_word,speaker:e.speaker}}))}}(e)}var r=n,i=r.words,o=r.paragraphs.map((function(e){return{speaker:e.speaker,start:e.start,previousTimings:te(i,e.start),startTimecode:q(e.start),type:"timedText",children:[{text:Q(e,i)}]}}));return o[0].children[0].words=i,o},ne=a(9),re=function(e){var t,a=e.intervalSeconds,n=void 0===a?30:a,r=e.transcriptData,i=0,o=r.words.sort((function(e,t){return e.start-t.start})),s=[],c=Object(ne.a)(o);try{for(c.s();!(t=c.n()).done;){var l=t.value;if(l.start-i>n){i=Math.floor(l.start/n)*n;var u=q(i);s.push({start:l.start,end:l.start+(l.end-l.start)/2,text:"[".concat(u,"]")}),l.start=l.start+(l.end-l.start)/2}s.push(l)}}catch(d){c.e(d)}finally{c.f()}return Object(w.a)({},r,{words:s})},ie=function(e){return function(t){return Array.from(new Set(t.map((function(t){return t[e]}))))}},oe=[{type:"srt",label:"Srt",ext:"srt"},{type:"vtt",label:"VTT",ext:"vtt"},{type:"vtt_speakers",label:"VTT with speakers",ext:"vtt"},{type:"itt",label:"iTT",ext:"itt"},{type:"ttml",label:"TTML",ext:"ttml"},{type:"premiereTTML",label:"TTML for Adobe Premiere",ext:"ttml"},{type:"csv",label:"CSV",ext:"csv"},{type:"pre-segment-txt",label:"Pre segmented txt",ext:"txt"},{type:"json",label:"Json",ext:"json"}],se=function(e){return e.trim().replace(/\s\s+/g," ").split(" ").length},ce=a(100),le=function(e){var t=e.value,a=e.speakers,n=e.timecodes,r=e.atlasFormat;return t.map((function(e){return r?"".concat(n?"".concat(a?e.speaker:"","\t[").concat(q(e.start),"]\t"):"","\t").concat(U.c.string(e)):"".concat(n?"".concat(q(e.start),"\t"):"").concat(a?e.speaker.toUpperCase():"").concat(a||n?"\n":"").concat(U.c.string(e))})).join("\n\n")},ue=function(e,t){var a=le({value:e,speakers:!1,timecodes:!1,atlasFormat:!1});return Object(ce.alignSTT)(t,a)},de=function(e,t){return function(e,t){var a=[],n=0;for(var r in e){var i=e[r],o=i.children[0].text,s=se(o),c=t.slice(n,n+s),l=i.speaker,u=parseFloat(c[0].start);l||(l="U_UKN");var d={type:"timedText",speaker:l,start:u,previousTimings:te(c,u),startTimecode:q(u),children:[{text:o}]};a.push(d),n+=s}return a}(e,ue(e,t))},pe=function(e,t){var a=ue(e,t);return{words:a,paragraphs:function(e,t){var a=[],n=0;for(var r in e){var i=e[r],o=i.children[0].text,s=se(o),c=t.slice(n,n+s),l=i.speaker;l||(l="U_UKN");var u={speaker:l,start:parseFloat(c[0].start),end:parseFloat(c[c.length-1].end)};a.push(u),n+=s}return a}(e,a)}},me=a(19),fe=function(e){var t=e.value,a=e.speakers,n=e.timecodes,r=e.inlineTimecodes,i=e.hideTitle,o=e.title,s=void 0===o?"Transcript":o,c=e.creator,l=void 0===c?"Slate Transcript Editor":c,u=e.description,d=void 0===u?"Transcript":u,p=new me.Document({creator:l,description:d,title:s});if(!i){var m=new me.TextRun(s),f=new me.Paragraph;f.addRun(m),f.heading1().center(),p.addParagraph(f);var h=new me.Paragraph;p.addParagraph(h)}t.forEach((function(e){var t=new me.Paragraph;if(n){var i=new me.TextRun(q(e.start));t.addRun(i)}if(a)if(n){var o=new me.TextRun(e.speaker).bold().tab();t.addRun(o)}else{var s=new me.TextRun(e.speaker).bold();t.addRun(s)}var c=U.c.string(e),l=new me.TextRun("").break();if(r&&t.addRun(new me.TextRun("".concat(e.speaker.toUpperCase(),":  ").concat(c))),(n||a||r)&&(p.addParagraph(t),p.addParagraph(new me.Paragraph)),!r){var u=new me.Paragraph(c);u.addRun(l),p.addParagraph(u)}})),(new me.Packer).toBlob(p).then((function(e){var t="".concat(s,".docx"),a=document.createElement("a");return a.href=window.URL.createObjectURL(e),a.download=t,a.click(),e}))};var he=function(e){return new Date(1e3*e.toFixed(3)).toISOString().substr(11,12)},ve=a(102),ge=a.n(ve);var be=function(e,t){var a=null;void 0!==t&&(a=t);var n={newline_boundaries:!0,html_boundaries:!1,sanitize:!1,allowed_tags:!1,abbreviations:a};return ge.a.sentences(e,n).join("\n")};var ye=function(e){return e.replace(/\n/g,"\n\n")};var we=function(e){return e.replace(/\n /g,"\n")};var xe=function(e,t){return e.split("\n\n").map((function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:35,a=0,n=e.map((function(e,n,r){if((a+=e.length+1)<=t){if(void 0!==r[n+1]){var i=r[n+1].length;return a+i<t?e:(a=0,"".concat(e,"\n"))}return e}return a=0,"".concat(e,"\n")}));return n}(e.split(" "),t)})).map((function(e){return e.join(" ")})).map((function(e){return we(e)})).join("\n\n")};var ke=function(e){return e.map((function(e){return e.replace(/^\s+/g,"")}))};var Ee=function(e){var t=e.split("\n"),a=0,n=t.map((function(e){return""===e?e:0===a?(a+=1,"."===e[e.length-1][0]?e+"\n\n":e+"\n"):1===a?(a=0,e+"\n\n"):void 0}));return n=(n=(n=ke(n)).filter((function(e){return 0!==e.length}))).join("").trim()};function Te(e){return e.map((function(e){return e.text})).join(" ")}var Se=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:35,a=e;"object"===typeof e&&(a=Te(e));var n=be(a),r=ye(n),i=xe(r,t),o=Ee(i);return o},je=/&/g,Ce=/</g,Oe=/>/g,Ne=function(e){return e.replace(je,"&amp;").replace(Ce,"&lt;").replace(Oe,"&gt;")},Re=function(e){var t='<?xml version="1.0" encoding="UTF-8" standalone="no" ?>\n    <tt xmlns="http://www.w3.org/ns/ttml"\n    xmlns:ttp="http://www.w3.org/ns/ttml#parameter"\n    ttp:timeBase="media"\n    xmlns:m608="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt#cea608"\n    xmlns:smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"\n    xmlns:ttm="http://www.w3.org/ns/ttml#metadata">\n    <head>\n    <metadata>\n    <smpte:information m608:captionService="F1C1CC" m608:channel="cc1"/>\n    </metadata>\n    <styling></styling>\n    <layout></layout>\n    </head>\n    <body><div>';return e.forEach((function(e){t+='<p begin="'.concat(he(parseFloat(e.start)),'" end="').concat(he(parseFloat(e.end)),'">').concat(Ne(e.text).replace(/\n/g,"<br />"),"</p>\n")})),"".concat(t+="</div>\n</body>\n</tt>")},Ae=a(103),De=a.n(Ae),Ie=function(e,t){return De()(Math.round(e),t,!1).toString().replace(/^00/,"01")},Le=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-GB",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,n='<?xml version="1.0" encoding="UTF-8"?>\n        <tt\n          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n          xmlns="http://www.w3.org/ns/ttml"\n          xmlns:tt="http://www.w3.org/ns/ttml"\n          xmlns:tts="http://www.w3.org/ns/ttml#styling"\n          xmlns:ttp="http://www.w3.org/ns/ttml#parameter"\n          xml:lang="'.concat(t,'"\n          ttp:timeBase="smpte"\n          ttp:frameRate="').concat(a,'"\n          ttp:frameRateMultiplier="').concat(25===a?"1 1":"999 1000",'"\n          ttp:dropMode="nonDrop"\n        >\n        <head>\n          <styling>\n            <style\n              xml:id="normal"\n              tts:fontFamily="sansSerif"\n              tts:fontWeight="normal"\n              tts:fontStyle="normal"\n              tts:color="white"\n              tts:fontSize="100%"\n            />\n          </styling>\n          <layout>\n            <region\n              xml:id="bottom"\n              tts:origin="0% 85%"\n              tts:extent="100% 15%"\n              tts:textAlign="center"\n              tts:displayAlign="after"\n            />\n          </layout>\n        </head>\n        <body style="normal" region="bottom">\n          <div begin="-01:00:00:00">');return e.forEach((function(e){n+='<p begin="'.concat(Ie(parseFloat(e.start)*a,a),'" end="').concat(Ie(parseFloat(e.end)*a,a),'">').concat(Ne(e.text).replace(/\n/g,"<br />"),"</p>\n")})),n+="</div>\n</body>\n</tt>"},Fe=function(e){var t='<?xml version="1.0" encoding="UTF-8"?>\n    <tt xmlns="http://www.w3.org/ns/ttml">\n    <head></head>\n    <body>\n    <div>';return e.forEach((function(e){t+='<p begin="'.concat(he(parseFloat(e.start)),'" end="').concat(he(parseFloat(e.end)),'">').concat(Ne(e.text).replace(/\n/g,"<br />"),"</p>\n")})),t+="</div>\n</body>\n</tt>"},Me=function(e){var t="";return e.forEach((function(e,a){t+="".concat(a+1,"\n").concat(he(parseFloat(e.start)).replace(".",",")," --\x3e ").concat(he(parseFloat(e.end)).replace(".",","),"\n").concat(e.text.trim(),"\n\n")})),t},Pe=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a="WEBVTT\n\n";return e.forEach((function(e,n){a+="".concat(n+1,"\n").concat(he(parseFloat(e.start))," --\x3e ").concat(he(parseFloat(e.end)),"\n").concat(t?"<v ".concat(e.speaker,">"):"").concat(e.text,"\n\n")})),a};var Ue=function(e){var t="N, In, Out, Text\n";return e.forEach((function(e,a){t+="".concat(a+1,","),t+='"'.concat(he(parseFloat(e.start)).replace(".",","),'","').concat(he(parseFloat(e.end)).replace(".",","),'",'),t+='"'.concat(e.text.replace(/\n/g,"\r\n"),'"\n')})),t};function _e(e){var t=e.split("\n\n");return t=t.map((function(e){return e.trim()}))}function Ke(e,t,a){e=e.filter((function(e){return e.text.length>0}));var n=0,r=0;return a.map((function(a){r+=se(a);var i={text:a.trim()};i.start=e[n].start,i.end=e[r-1].end;var o=t.filter((function(e){return i.start>=e.start&&i.start<e.end})).map((function(e){var t=(Math.min(i.end,e.end)-i.start)/(i.end-i.start);return Object(w.a)({},e,{pctInParagraph:t})})).sort((function(e,t){return t.pctInParagraph-e.pctInParagraph||e.start-t.start}));return i.speaker=o.length>0?o[0].speaker:"UNKNOWN",n=r,i}))}function Be(e,t){var a,n=[],r="0",i=t.sort((function(e,t){return e.start-t.start})),o=Object(ne.a)(e);try{var s=function(){var e=a.value,t=e.text,o=e.start,s=i.filter((function(e){return e.start<=o&&e.end>=o}))[0];s.id!==r&&(r=s.id,n.push("\n\n")),n.push(t)};for(o.s();!(a=o.n()).done;)s()}catch(c){o.e(c)}finally{o.f()}return n.join(" ")}var ze=function(e){var t=e.words,a=e.paragraphs,n=e.type,r=e.numberOfCharPerLine,i=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=_e(n?Be(e,t):Se(e,a));return Ke(e,t,r)}(t,a,r,"vtt_speakers_paragraphs"===n);if("string"===typeof t)return Se(t,r);switch(n){case"premiereTTML":return Re(i);case"ttml":return Fe(i);case"itt":return Le(i);case"srt":return Me(i);case"vtt":return Pe(i);case"vtt_speakers":case"vtt_speakers_paragraphs":return Pe(i,!0);case"json":return i.map((function(e){return e.start=he(parseFloat(e.start)).replace(".",","),e.end=he(parseFloat(e.end)).replace(".",","),e}));case"csv":return Ue(i);case"pre-segment-txt":case"txt":return Se(t,r);default:return"Could not find the subtitle format"}},We=oe.map((function(e){return e.type})),Ge=function(e){var t=e.slateValue,a=e.type,n=(e.ext,e.transcriptTitle),r=e.speakers,i=e.timecodes,o=e.inlineTimecodes,s=e.hideTitle,c=e.atlasFormat,l=e.dpeTranscriptData;switch(a){case"text":return le({value:t,speakers:r,timecodes:i,atlasFormat:c});case"json-slate":return t;case"json-digitalpaperedit":return pe(t,l);case"word":return fe({title:n,value:t,speakers:r,timecodes:i,inlineTimecodes:o,hideTitle:s});default:if(function(e){return We.includes(e)}(a)){var u=pe(t,t[0].children[0]);return u.paragraphs.forEach((function(e){"Add speaker"===e.speaker&&(e.speaker="")})),ze({words:u.words,paragraphs:u.paragraphs,type:a})}return console.error("Did not recognise the export format ",a),"Did not recognise the export format"}};var He=function(e){return 0===Object.keys(e).length},Ve=function(e,t){if(He(t))return"";var a=t[t.length-1].start,n=parseInt(a),r=Array(n);return Object(x.a)(r.keys()).splice(0,e,0).join(" ")},Je={ab:"Abkhazian",aa:"Afar",af:"Afrikaans",ak:"Akan",sq:"Albanian",am:"Amharic",ar:"Arabic",an:"Aragonese",hy:"Armenian",as:"Assamese",av:"Avaric",ae:"Avestan",ay:"Aymara",az:"Azerbaijani",bm:"Bambara",ba:"Bashkir",eu:"Basque",be:"Belarusian",bn:"Bengali",bh:"Bihari languages",bi:"Bislama",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan, Valencian",km:"Central Khmer",ch:"Chamorro",ce:"Chechen",ny:"Chichewa, Chewa, Nyanja",zh:"Chinese","zh-TW":"Chinese (Traditional)",cu:"Church Slavonic, Old Bulgarian, Old Church Slavonic",cv:"Chuvash",kw:"Cornish",co:"Corsican",cr:"Cree","zh-Hans":"Chinese (Simplified)","zh-Hant":"Chinese (Traditional)",hr:"Croatian",cs:"Czech",da:"Danish",dv:"Divehi, Dhivehi, Maldivian",nl:"Dutch, Flemish",dz:"Dzongkha",en:"English",eo:"Esperanto",et:"Estonian",ee:"Ewe",fo:"Faroese",fj:"Fijian",fi:"Finnish",fil:"Filipino","fr-FR":"French",fr:"French",ff:"Fulah",gd:"Gaelic, Scottish Gaelic",gl:"Galician",lg:"Ganda",ka:"Georgian",de:"German",ki:"Gikuyu, Kikuyu",el:"Greek (Modern)",kl:"Greenlandic, Kalaallisut",gn:"Guarani",gu:"Gujarati",ht:"Haitian, Haitian Creole",ha:"Hausa",haw:"Hawaiian",he:"Hebrew",hz:"Herero",hi:"Hindi",ho:"Hiri Motu",hu:"Hungarian",is:"Icelandic",io:"Ido",ig:"Igbo",id:"Indonesian",ia:"Interlingua (International Auxiliary Language Association)",ie:"Interlingue",iu:"Inuktitut",ik:"Inupiaq",iw:"Hebrew",ga:"Irish",it:"Italian",ja:"Japanese",jv:"Javanese",kn:"Kannada",kr:"Kanuri",ks:"Kashmiri",kk:"Kazakh",kri:"Krio",rw:"Kinyarwanda",kv:"Komi",kg:"Kongo",ko:"Korean",kj:"Kwanyama, Kuanyama",ku:"Kurdish",ky:"Kyrgyz",lo:"Lao",la:"Latin",lv:"Latvian",lb:"Letzeburgesch, Luxembourgish",li:"Limburgish, Limburgan, Limburger",ln:"Lingala",lt:"Lithuanian",lu:"Luba-Katanga",mk:"Macedonian",mg:"Malagasy",ms:"Malay",ml:"Malayalam",mt:"Maltese",gv:"Manx",mi:"Maori",mr:"Marathi",mh:"Marshallese",ro:"Moldovan, Moldavian, Romanian",mn:"Mongolian",nso:"Northern Sotho",na:"Nauru",nv:"Navajo, Navaho",nd:"Northern Ndebele",ng:"Ndonga",ne:"Nepali",se:"Northern Sami",no:"Norwegian",nb:"Norwegian Bokm\xe5l",nn:"Norwegian Nynorsk",ii:"Nuosu, Sichuan Yi",oc:"Occitan (post 1500)",oj:"Ojibwa",or:"Oriya",om:"Oromo",os:"Ossetian, Ossetic",pi:"Pali",pa:"Panjabi, Punjabi",ps:"Pashto, Pushto",fa:"Persian",pl:"Polish",pt:"Portuguese",qu:"Quechua",rm:"Romansh",rn:"Rundi",ru:"Russian",sm:"Samoan",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sr:"Serbian",sn:"Shona",sd:"Sindhi",si:"Sinhala, Sinhalese",sk:"Slovak",sl:"Slovenian",so:"Somali",st:"Sotho, Southern",nr:"South Ndebele",es:"Spanish","es-419":"Spanish (Latin America)",su:"Sundanese",sw:"Swahili",ss:"Swati",sv:"Swedish",tl:"Tagalog",ty:"Tahitian",tg:"Tajik",ta:"Tamil",tt:"Tatar",te:"Telugu",th:"Thai",bo:"Tibetan",ti:"Tigrinya",to:"Tonga (Tonga Islands)",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",tw:"Twi",ug:"Uighur, Uyghur",uk:"Ukrainian",ur:"Urdu",uz:"Uzbek",ve:"Venda",vi:"Vietnamese",vo:"Volap_k",wa:"Walloon",cy:"Welsh",fy:"Western Frisian",wo:"Wolof",xh:"Xhosa",yi:"Yiddish",yo:"Yoruba",za:"Zhuang, Chuang",zu:"Zulu"},qe=a(104),Ye=function(e){var t=e.match(/[?&]v=([^&#]+)/);return t?t[1]:""},Ze=function(e){var t=Object(n.useRef)(null),a=e.mediaUrl.includes("youtube.com");return r.a.createElement("div",{className:"wd-100"},a?r.a.createElement(qe.a,{videoId:Ye(e.mediaUrl),opts:{playerVars:{autoplay:0,fs:0,loop:1,showinfo:0,modestbranding:1,playsinline:1,enablejsapi:1}},onReady:function(a){t.current=a.target,e.setPlayer(t)},iframeClassName:"wd-100 height-25vh"}):r.a.createElement("video",{ref:e.mediaRef,src:e.mediaUrl,width:e.width,height:e.height,controls:!0,playsInline:!0}))};function Xe(){var e=Object(k.a)(["\n          font-weight: ",";\n          background-color: ",";\n        "]);return Xe=function(){return e},e}var $e=[.2,.25,.5,.75,1,1.25,1.5,1.75,2,2.25,2.5,3,3.5];function Qe(e){var t=this,a=Object(n.useState)(null),i=Object(E.a)(a,2),o=i[0],s=i[1],u=Object(n.useRef)(null),d=Object(n.useState)(0),p=Object(E.a)(d,2),m=p[0],f=p[1],h=Object(n.useState)(0),v=Object(E.a)(h,2),g=(v[0],v[1]),b=Object(n.useState)(1),y=Object(E.a)(b,2),k=y[0],T=y[1],W=Object(n.useMemo)((function(){return Object(_.d)(Object(K.a)(Object(U.i)()))}),[]),G=Object(n.useState)([]),H=Object(E.a)(G,2),V=H[0],Z=H[1],X="boolean"!==typeof e.showSpeakers||e.showSpeakers,$="boolean"!==typeof e.showTimecodes||e.showTimecodes,Q=Object(n.useState)(X),ee=Object(E.a)(Q,2),te=(ee[0],ee[1],Object(n.useState)($)),ne=Object(E.a)(te,2),se=(ne[0],ne[1],Object(n.useState)([])),ce=Object(E.a)(se,2),le=(ce[0],ce[1]),ue=Object(n.useState)(!1),pe=Object(E.a)(ue,2),me=pe[0],fe=(pe[1],Object(n.useState)(null)),he=Object(E.a)(fe,2),ve=he[0],ge=he[1],be=Object(n.useState)(!1),ye=Object(E.a)(be,2),we=ye[0],xe=ye[1],ke=Object(n.useState)(!1),Ee=Object(E.a)(ke,2),Te=Ee[0],Se=Ee[1],je=Object(n.useState)(!1),Ce=Object(E.a)(je,2),Oe=Ce[0],Ne=Ce[1],Re=Object(n.useState)(""),Ae=Object(E.a)(Re,2),De=Ae[0],Ie=Ae[1],Le=Object(n.useState)(""),Fe=Object(E.a)(Le,2),Me=Fe[0],Pe=Fe[1],Ue=Object(n.useState)(e.metadata.description),_e=Object(E.a)(Ue,2),Ke=_e[0],Be=_e[1],ze=Object(n.useState)(e.metadata.language),We=Object(E.a)(ze,2),He=We[0],qe=We[1],Ye=Object(n.useState)(!!e.metadata.is_public),Qe=Object(E.a)(Ye,2),et=Qe[0],tt=Qe[1],at=Object(n.useState)(!!e.metadata.is_caption),nt=Object(E.a)(at,2),rt=nt[0],it=nt[1],ot=Object(n.useState)(!!e.metadata.is_downloadable),st=Object(E.a)(ot,2),ct=st[0],lt=st[1],ut=Object(n.useState)(0),dt=Object(E.a)(ut,2),pt=dt[0],mt=dt[1],ft=Object(n.useState)(0),ht=Object(E.a)(ft,2),vt=ht[0],gt=ht[1];Object(n.useEffect)((function(){document.body.style.cursor=Te?"wait":"default"}),[Te]),Object(n.useEffect)((function(){if(e.transcriptData){var t=ae(e.transcriptData,e.sttType);Z(t)}}),[]),Object(n.useEffect)((function(){e.setTranscriptDataSaved(!1)}),[Oe]),Object(n.useEffect)((function(){if(e.transcriptDataLive){var t=ae(e.transcriptDataLive,e.sttType);if(W.selection){var a=[W.children.length];U.h.insertNodes(W,t,{at:a})}else U.h.insertNodes(W,t)}}),[e.transcriptDataLive]),Object(n.useEffect)((function(){var e=ie("speaker")(V);le(e)}),[me]),Object(n.useEffect)((function(){return e.mediaRef&&e.mediaRef.current&&e.mediaRef.current.addEventListener("timeupdate",wt),function(){e.mediaUrl.includes("youtube.com")||e.mediaRef.current.removeEventListener("timeupdate",wt)}}),[]);var bt=function(){return e.title?e.title:S.a.basename(e.mediaUrl).trim()},yt=function(){var t=S.a.extname(e.mediaUrl),a=e.mediaType?e.mediaType:"video";return".wav"!==t&&".mp3"!==t&&".m4a"!==t&&".flac"!==t&&".aiff"!==t||(a="audio"),a},wt=function(t){f(t.target.currentTime),g(e.mediaRef.current.duration)};Object(n.useEffect)((function(){o&&(u.current=o.current)}),[o]);var xt=Object(n.useCallback)((function(e){return r.a.createElement(Nt,e)}),[]),kt=Object(n.useCallback)((function(e){var t=Object(E.a)(e,2),a=t[0],n=t[1],r=[];if(De&&U.g.isText(a)){var i=a.text.split(De),o=0;i.forEach((function(e,t){0!==t&&r.push({anchor:{path:n,offset:o-De.length},focus:{path:n,offset:o},highlight:!0}),o=o+e.length+De.length}))}return r}),[De]);Object(n.useEffect)((function(){var e=setTimeout((function(){var e=document.getElementById("total-hits"),t=document.querySelectorAll('span[data-cy="search-highlighted"]');mt(t.length),vt>=t.length&&t.length>0&&gt(vt%t.length),t.length>0&&(t[vt].classList.add("current-highlighted"),t[vt].scrollIntoView({behavior:"smooth",block:"center"})),0!==De.length&&0!==pt||(e.classList.remove("has-content"),e.innerHTML=""),pt>0&&(e.classList.add("has-content"),e.innerHTML=pt+" matches")}),150);return function(){return clearTimeout(e)}}),[De,pt]);var Et=function(){var e=Object(l.a)(c.a.mark((function e(t){var a,n,r,i,o,s,l,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_.b.findPath(W,t),n=t.speaker,e.next=4,Tt("Change speaker name",n,!0);case 4:if(!(r=e.sent)){e.next=14;break}return i="add speaker"!==n.toString().toLowerCase()?"Would you like to replace all occurrences of ".concat(n," with ").concat(r,"?"):"Would you like to add speaker ".concat(r," to this line or all lines?"),e.next=9,Tt(i,null,!1,!0);case 9:(o=e.sent)?(s=U.a.range(W,[]),U.h.setNodes(W,{type:"timedText",speaker:r},{at:s,match:function(e){return"timedText"===e.type&&e.speaker.toString().toLowerCase()===n.toString().toLowerCase()}})):!1===o&&U.h.setNodes(W,{type:"timedText",speaker:r},{at:a}),l=Dt(W.children),u=l<17?l+1:17,document.querySelectorAll(".speakers-col").forEach((function(e){e.style.minWidth=u+"ch"}));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Tt=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Promise((function(r){var i=document.createElement("div");i.setAttribute("role","dialog"),i.setAttribute("aria-modal","true"),i.setAttribute("aria-labelledby","promptMessage"),i.classList.add("dialog-container");var o=document.createElement("p");o.setAttribute("id","promptMessage"),o.textContent=e,i.appendChild(o);var s=document.createElement("input");if(a)if("Change speaker name"!==e)s.setAttribute("type","text"),s.setAttribute("aria-label",e),s.value=t||"",i.appendChild(s);else{s.setAttribute("type","text"),s.setAttribute("aria-label",e),s.value="";var c=document.createElement("datalist"),l=Object(x.a)(new Set(W.children.map((function(e){return e.speaker})).filter((function(e){return"Add speaker"!==e}))));c.id="speaker-suggestions",l.forEach((function(e){var t=document.createElement("option");t.value=e,c.appendChild(t)})),s.setAttribute("list","speaker-suggestions"),i.appendChild(s),i.appendChild(c)}if(n){var u=document.createElement("button");u.textContent="Replace One",u.addEventListener("click",(function(){var e=!!a&&s.value;r(e),document.body.removeChild(i)})),i.appendChild(u)}var d=document.createElement("button");d.textContent=n?"Replace All":"OK",d.addEventListener("click",(function(){var e=!a||s.value;r(e),document.body.removeChild(i)})),i.appendChild(d);var p=document.createElement("button");p.textContent="Cancel",p.addEventListener("click",(function(){document.body.removeChild(i)})),i.appendChild(p),document.body.appendChild(i),(a?s:d).focus()}))},St=function(){var e=Object(l.a)(c.a.mark((function e(t){var a,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_.b.findPath(W,t),n=t.startTimecode,e.next=4,Tt("Change timecode",n,!0);case 4:r=e.sent,jt(r)&&Ct(r,a)?U.h.setNodes(W,{type:"timedText",startTimecode:r,start:J(r)},{at:a}):alert("Please enter the time code in the correct format HH:MM:SS and make sure that it is between the previous and next time code");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),jt=function(e){return e&&/^(?:[01]\d|2[0-3]):(?:[0-5]\d):(?:[0-5]\d)$/.test(e)},Ct=function(e,t){var a,n,r=J(null===(a=W.children[t[0]-1])||void 0===a?void 0:a.startTimecode),i=J(null===(n=W.children[t[0]+1])||void 0===n?void 0:n.startTimecode),o=J(e);return isNaN(r)&&o<=i||isNaN(i)&&o>=r||o>=r&&o<=i},Ot=function(){var t=Object(l.a)(c.a.mark((function t(a){var n,r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=_.b.findPath(W,a),r="",e.mediaRef&&e.mediaRef.current?r=e.mediaRef.current.currentTime:u&&u.current&&(r=u.current.getCurrentTime()),U.h.setNodes(W,{type:"timedText",startTimecode:q(r),start:J(r)},{at:n});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Nt=function(e){return r.a.createElement(A.a,Object.assign({},e.attributes,{className:"mb-3 border-bottom pb-3",style:{}}),r.a.createElement(D.a,{contentEditable:!1,className:"text-truncate p-0 pl-3 col-auto"},r.a.createElement("code",{contentEditable:!1,style:{cursor:"pointer"},className:"timecode text-muted unselectable",onClick:It,title:e.element.startTimecode,"data-start":e.element.start},e.element.startTimecode,r.a.createElement(z.a,{icon:B.c,onClick:St.bind(t,e.element),onKeyDown:function(t){return At(t,e.element)},pull:"left",className:"mt-1",tabIndex:0,role:"button",title:"Edit Timecode"+e.element.startTimecode,"aria-label":"Edit timecode"+e.element.startTimecode}),r.a.createElement(z.a,{icon:B.g,onClick:Ot.bind(t,e.element),pull:"left",className:"mt-1",tabIndex:0,role:"button"}))),r.a.createElement(D.a,{contentEditable:!1,className:"p-0 pl-3 text-left col-auto speakers-col",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"17ch"}},r.a.createElement("span",{contentEditable:!1,className:"text-muted",tabIndex:0,style:{cursor:"pointer"},title:e.element.speaker,onClick:Et.bind(t,e.element),onKeyDown:function(t){return Rt(t,e.element)}},e.element.speaker)),r.a.createElement(D.a,{className:"p-b-1 wd-fit",tabIndex:1},e.children))},Rt=function(e,t){" "!==e.key&&"Spacebar"!==e.key||(e.preventDefault(),Et(t))},At=function(e,t){" "!==e.key&&"Spacebar"!==e.key||(e.preventDefault(),St(t))},Dt=function(e){var t=0;return e.forEach((function(e){e.speaker&&e.speaker.length>t&&(t=e.speaker.length)})),t>17?17:t+1},It=function(t){if(t.target.classList.contains("timecode"))if(u&&u.current){var a=parseFloat(t.target.dataset.start);u.current.seekTo(a,!0)}else{var n=t.target.dataset.start;e.mediaRef&&e.mediaRef.current&&(e.mediaRef.current.currentTime=parseFloat(n),e.mediaRef.current.play())}else if(t.target.dataset.slateString&&t.target.parentNode.dataset.start){var r=t.target.parentNode.dataset.start;e.mediaRef&&e.mediaRef.current&&r&&(e.mediaRef.current.currentTime=parseFloat(r),e.mediaRef.current.play())}},Lt=function(){var t=Object(l.a)(c.a.mark((function t(){var a,n,r,i,o=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=o.length>0&&void 0!==o[0]&&o[0],Oe||a){t.next=3;break}return t.abrupt("return",V);case 3:if(!a){t.next=13;break}return n=re({transcriptData:e.transcriptData}),t.next=7,de(ae(n,e.sttType),n);case 7:return r=t.sent,Z(r),Ne(!1),t.abrupt("return",r);case 13:return t.next=15,de(V,e.transcriptData);case 15:return i=t.sent,Z(i),Ne(!1),t.abrupt("return",i);case 19:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Ft=function(){var t=Object(l.a)(c.a.mark((function t(a){var n,r,i,o,s,l,u,d,p,m;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.type,r=a.ext,i=a.speakers,o=a.timecodes,s=a.inlineTimecodes,l=a.hideTitle,u=a.atlasFormat,d=a.isDownload,t.prev=1,Se(!0),p=V,!o){t.next=8;break}return t.next=7,Lt();case 7:p=t.sent;case 8:if(!s){t.next=12;break}return t.next=11,Lt(s);case 11:p=t.sent;case 12:return m=Ge({slateValue:p,type:n,transcriptTitle:bt(),speakers:i,timecodes:o,inlineTimecodes:s,hideTitle:l,atlasFormat:u,dpeTranscriptData:e.transcriptData}),"json"===r&&(m=JSON.stringify(m,null,2)),"docx"!==r&&d&&Y(m,"".concat(bt(),".").concat(r)),t.abrupt("return",m);case 16:return t.prev=16,Se(!1),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[1,,16,19]])})));return function(e){return t.apply(this,arguments)}}(),Mt=function(){var t=Object(l.a)(c.a.mark((function t(){var a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{Se(!0),a=e.autoSaveContentType?e.autoSaveContentType:"digitalpaperedit",Ft({type:"json-".concat(a),isDownload:!1}).then((function(t){e.handleSaveEditor&&e.handleSaveEditor(t,{description:Ke,language:He,isDownloadable:ct,isCaption:rt,isPublic:et})}))}finally{Se(!1)}case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Pt=function(){var t=Object(l.a)(c.a.mark((function t(){var a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{Se(!0),a=e.autoSaveContentType?e.autoSaveContentType:"digitalpaperedit",Ft({type:"json-".concat(a),isDownload:!1}).then((function(t){e.handleSaveAndClose&&e.handleSaveAndClose(t,{description:Ke,language:He,isDownloadable:ct,isCaption:rt,isPublic:et})}))}finally{Se(!1)}case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return r.a.createElement(R.a,{fluid:!0,style:{backgroundColor:"#eee",height:"100vh",paddingTop:"1em"}},r.a.createElement("style",{scoped:!0},'\n              /* Next words */\n             .timecode[data-previous-timings*="'.concat(Ve(parseInt(m),V),'"]{\n                  color:  #9E9E9E;\n              }\n          ')),r.a.createElement("style",{scoped:!0},".editor-wrapper-container{\n                padding: 8px 16px;\n                background: #f9f9f9;\n                box-shadow: 0 0 10px #ccc;\n                height: 90vh;\n                overflow: auto;\n              }\n              /* https://developer.mozilla.org/en-US/docs/Web/CSS/user-select\n              TODO: only working in Chrome, not working in Firefox, and Safari - OSX\n              if selecting text, not showing selection\n              Commented out because it means cannot select speakers and timecode anymore\n              which is the intended default behavior but needs to come with export\n              functionality to export as plain text, word etc.. otherwise user won't be able\n              to get text out of component with timecodes and speaker names in the interim */\n              .unselectable {\n                -moz-user-select: none;\n                -webkit-user-select: none;\n                -ms-user-select: none;\n                user-select: none;\n              }\n              .timecode:hover{\n                text-decoration: underline;\n              }\n              .timecode.text:hover{\n                text-decoration:none;\n              }\n              "),r.a.createElement("div",{id:"skiptocontent",className:"skiptocontent",tabIndex:"1",onKeyUp:function(e){13!==e.keyCode&&32!==e.keyCode||U.h.select(W,{anchor:{path:[0,0],offset:0},focus:{path:[0,0],offset:0}})}},"Skip to main content"),r.a.createElement(A.a,null,e.showTitle?r.a.createElement("div",{className:"text-truncate text-left top-title"},r.a.createElement("span",null,"Editing transcript "),r.a.createElement(P.a,{placement:"bottom",overlay:r.a.createElement(M.a,{id:"tooltip-disabled"},"Click and edit to edit the transcript title and then hit save icon to save it")},r.a.createElement("span",{className:"display-inline fw-bold editable",contentEditable:!0,onBlur:function(t){t.keycode>=37&&t.keycode<=40||(t.keycode>=13?t.preventDefault():e.handleSaveTranscriptTitle(t.target.innerHTML))}},e.title)),r.a.createElement("span",null," of "),r.a.createElement("span",{className:"display-inline fw-bold"},e.resourceTitle)):null,r.a.createElement("div",{className:"find-replace-container"},r.a.createElement(I.a,null,r.a.createElement(A.a,null,r.a.createElement(D.a,{className:"tl-right",xs:3,sm:3,md:3,lg:7,xl:8},r.a.createElement(I.a.Group,{controlId:"findReplaceContentFields"},r.a.createElement(A.a,null,r.a.createElement("span",{id:"total-hits",style:{minWidth:"150px"}}),r.a.createElement(D.a,null,r.a.createElement(I.a.Control,{as:"input",value:De,placeholder:"Find",onChange:function(e){return Ie(e.target.value)}})),r.a.createElement(P.a,{placement:"bottom",overlay:r.a.createElement(M.a,{id:"tooltip-disabled"},"Move to next")},r.a.createElement(z.a,{icon:B.a,onClick:function(){if(De){var e=document.querySelectorAll('span[data-cy="search-highlighted"]'),t=(vt+1)%e.length;e[vt].classList.remove("current-highlighted"),e[t].classList.add("current-highlighted"),gt(t),e[t].scrollIntoView({behavior:"smooth",block:"center"})}},pull:"left",className:"mt-2 cursor-pointer",tabIndex:0,role:"button",size:"lg"})),r.a.createElement(P.a,{placement:"bottom",overlay:r.a.createElement(M.a,{id:"tooltip-disabled"},"Move to previous")},r.a.createElement(z.a,{icon:B.b,onClick:function(){if(De){var e=document.querySelectorAll('span[data-cy="search-highlighted"]'),t=0===vt?e.length-1:(vt-1+e.length)%e.length;e[vt].classList.remove("current-highlighted"),e[t].classList.add("current-highlighted"),gt(t),e[t].scrollIntoView({behavior:"smooth",block:"center"})}},pull:"left",className:"mt-2 ml-2 cursor-pointer",tabIndex:0,role:"button",size:"lg"})),r.a.createElement(D.a,null,r.a.createElement(I.a.Control,{as:"input",placeholder:"Replace",value:Me,onChange:function(e){return Pe(e.target.value)}}))))),r.a.createElement(D.a,{className:"tl-right",xs:3,sm:3,md:3,lg:4,xl:4},r.a.createElement(A.a,null,r.a.createElement(D.a,{className:"pl-0 pr-0"},r.a.createElement(C.a,{variant:"primary",onClick:function(){for(var e=W.children,t=Array.from(document.querySelectorAll('span[data-cy="search-highlighted"]')),a=e.map((function(e){return e.children[0].text.split(De).length-1})),n=vt,r=0,i=0,o=0;o<a.length;o++)i-1<n&&a[o]+i>n&&(r=o),i+=a[o];var s=e[r].children[0].text,c=s.split(De).length-1,l=0,u=new RegExp(De,"g"),d=n%c;d=0===d?1:d+1;var p=s.replace(u,(function(e){return++l===d?Me:e})),m=Object(w.a)({},JSON.parse(JSON.stringify(e[r])),{children:[{text:p}]});U.h.insertNodes(W,m,{at:[r]}),U.h.removeNodes(W,{at:[r+1]}),mt(pt-1),u.test(Me)&&gt(n+1),n===t.length-1&&gt(0)},className:"btn-update-description replace-btn"},"Replace One")),r.a.createElement(D.a,{className:"pl-0"},r.a.createElement(C.a,{variant:"primary",onClick:function(){for(var e=W.children,t=0;t<e.length;t++){var a=e[t].children[0].text.replaceAll(De,Me),n=JSON.parse(JSON.stringify(e[t]));n.children[0].text=a,U.h.insertNodes(W,Object(w.a)({},n),{at:[t]}),U.h.removeNodes(W,{at:[t+1]})}},className:"btn-update-description replace-btn"},"Replace All")))))))),r.a.createElement(A.a,null,r.a.createElement(D.a,{xs:{span:12,order:1},sm:"audio"===yt()?{span:10,offset:1}:3,md:"audio"===yt()?{span:10,offset:1}:3,lg:"audio"===yt()?{span:8,offset:2}:3,xl:"audio"===yt()?{span:8,offset:2}:3,className:"d-flex flex-column"},r.a.createElement(A.a,null,r.a.createElement(Ze,{mediaRef:e.mediaRef,mediaUrl:e.mediaUrl,width:"100%",height:"audio"===yt()?"60em":"auto",controls:!0,playsInline:!0,setPlayer:function(e){s(e)}})),r.a.createElement(A.a,null,r.a.createElement(D.a,{xs:5,sm:1,md:1,lg:1,xl:2,className:"pt-1 pl-0"},r.a.createElement(C.a,{variant:"primary",onClick:Pt,className:"btn-update-description save-close-btn"},"Save & Close")),r.a.createElement(D.a,{xs:4,sm:2,md:2,lg:2,xl:2,className:"p-1 ml-auto",style:{marginRight:"5px"}},r.a.createElement(I.a.Control,{as:"select",defaultValue:k,onChange:function(t){var a=parseFloat(t.target.value);e.mediaRef&&e.mediaRef.current?(e.mediaRef.current.playbackRate=a,T(a)):u&&u.current&&u.current.setPlaybackRate(a)},title:"Change the playback speed of the player",className:"p-0"},$e.map((function(e,t){return r.a.createElement("option",{key:t+e,value:e},"x ",e)})))),r.a.createElement(D.a,{xs:3,sm:3,md:3,lg:2,xl:1,className:"p-1"},r.a.createElement(P.a,{delay:1e3,placement:"bottom",overlay:r.a.createElement(M.a,{id:"tooltip-disabled"},"Seek back by ".concat(15," seconds"))},r.a.createElement("span",{className:"d-inline-block"},r.a.createElement(C.a,{variant:"light",onClick:function(){if(e.mediaRef&&e.mediaRef.current)e.mediaRef.current.currentTime=e.mediaRef.current.currentTime-15;else if(u&&u.current){var t=u.current.getCurrentTime();u.current.seekTo(t-15)}},block:!0,className:"fs-17"},r.a.createElement(z.a,{icon:B.h}))))),r.a.createElement(D.a,{xs:3,sm:3,md:3,lg:2,xl:1,className:"p-1",style:{marginLeft:"15px"}},r.a.createElement(P.a,{OverlayTrigger:!0,delay:2e3,placement:"bottom",overlay:r.a.createElement(M.a,{id:"tooltip-disabled"},"Export options")},r.a.createElement("span",{className:"d-inline-block"},r.a.createElement(O.a,{disabled:Te,id:"dropdown-basic-button",title:r.a.createElement(z.a,{icon:B.d}),variant:"light"},r.a.createElement(N.a.Item,{style:{color:"black"},disabled:!0},r.a.createElement("b",null,"Text Export")),r.a.createElement(N.a.Item,{onClick:function(){Ft({type:"text",ext:"txt",speakers:!1,timecodes:!1,isDownload:!0})}},"Text (",r.a.createElement("code",null,".txt"),")"),r.a.createElement(N.a.Item,{onClick:function(){Ft({type:"text",ext:"txt",speakers:!0,timecodes:!1,isDownload:!0})}},"Text (Speakers)"),r.a.createElement(N.a.Item,{onClick:function(){Ft({type:"text",ext:"txt",speakers:!1,timecodes:!0,isDownload:!0})}},"Text (Timecodes)"),r.a.createElement(N.a.Item,{onClick:function(){Ft({type:"text",ext:"txt",speakers:!0,timecodes:!0,isDownload:!0})},disable:!0},"Text (Speakers & Timecodes)"),r.a.createElement(N.a.Item,{onClick:function(){Ft({type:"text",ext:"txt",speakers:!0,timecodes:!0,atlasFormat:!0,isDownload:!0})},disable:!0},"Text (Atlas format)"),r.a.createElement(N.a.Divider,null),r.a.createElement(N.a.Item,{onClick:function(){Ft({type:"word",ext:"docx",speakers:!1,timecodes:!1,isDownload:!0})}},"Word (",r.a.createElement("code",null,".docx"),")"),r.a.createElement(N.a.Item,{onClick:function(){Ft({type:"word",ext:"docx",speakers:!0,timecodes:!1,isDownload:!0})}},"Word (Speakers)"),r.a.createElement(N.a.Item,{onClick:function(){Ft({type:"word",ext:"docx",speakers:!1,timecodes:!0,isDownload:!0})}},"Word (Timecodes)"),r.a.createElement(N.a.Item,{onClick:function(){Ft({type:"word",ext:"docx",speakers:!0,timecodes:!0,isDownload:!0})}},"Word (Speakers & Timecodes)"),r.a.createElement(N.a.Item,{onClick:function(){Ft({type:"word",ext:"docx",speakers:!1,timecodes:!1,inlineTimecodes:!0,hideTitle:!0})}},"Word (OHMS)"),r.a.createElement(N.a.Divider,null),r.a.createElement(N.a.Item,{style:{color:"black"},disabled:!0},r.a.createElement("b",null,"Closed Captions Export")),oe.map((function(e,t){var a=e.type,n=e.label,i=e.ext;return r.a.createElement(N.a.Item,{key:t+n,onClick:function(){Ft({type:a,ext:i,isDownload:!0})}},n," (",r.a.createElement("code",null,".",i),")")})))))),r.a.createElement(D.a,{xs:3,sm:3,md:3,lg:2,xl:1,className:"p-1",style:{marginLeft:"21px"}},r.a.createElement(P.a,{OverlayTrigger:!0,delay:2e3,placement:"bottom",overlay:r.a.createElement(M.a,{id:"tooltip-disabled"},"Save")},r.a.createElement(C.a,{disabled:Te,onClick:Mt,variant:"light",className:"fs-17"},r.a.createElement(z.a,{icon:B.f})))),r.a.createElement(D.a,{xs:3,sm:3,md:3,lg:2,xl:1,className:"p-1",style:{marginLeft:"10px"}},r.a.createElement(P.a,{delay:1e3,placement:"bottom",overlay:r.a.createElement(M.a,{id:"tooltip-disabled"},"Turn ",we?"off":"on"," pause while typing functionality. As you start typing the media while pause playback until you stop. Not reccomended on longer transcript as it might present performance issues.")},r.a.createElement(C.a,{disabled:Te,onClick:function(){xe(!we)},variant:we?"secondary":"light",className:"fs-17"},r.a.createElement(z.a,{icon:B.e}))))),r.a.createElement(A.a,{className:"flex-grow-1 align-items-end"},r.a.createElement(D.a,{className:"p-0 d-flex flex-column"},r.a.createElement("div",{className:"metadata-editor-container"},r.a.createElement(L.a,{defaultActiveKey:"description",id:"tabs"},r.a.createElement(F.a,{eventKey:"description",title:"Description"},r.a.createElement(I.a,{className:"pt-3 flex-grow-1"},r.a.createElement(I.a.Group,{controlId:"descriptionField"},r.a.createElement(I.a.Label,null,"Description"),r.a.createElement(I.a.Control,{as:"textarea",rows:3,value:Ke,onChange:function(e){return Be(e.target.value)},style:{resize:"none"}})),r.a.createElement(I.a.Group,{controlId:"languageDropdown"},r.a.createElement(I.a.Label,null,"Language"),r.a.createElement(I.a.Control,{as:"select",value:He,onChange:function(e){return qe(e.target.value)}},Object.keys(Je).map((function(e){return r.a.createElement("option",{key:e,value:e},Je[e])})))),r.a.createElement(I.a.Group,{controlId:"publicDropdown"},r.a.createElement(I.a.Label,null,"Public"),r.a.createElement(I.a.Control,{as:"select",value:et,onChange:function(e){return tt(e.target.value)}},r.a.createElement("option",{value:"true"},"Yes"),r.a.createElement("option",{value:"false"},"No"))),r.a.createElement(I.a.Group,{controlId:"captionCheckbox",className:"custom-checkbox"},r.a.createElement(I.a.Check,{type:"checkbox",label:"Is Caption?",checked:rt,onChange:function(e){return it(e.target.checked)},className:"custom-checkbox-input"})),r.a.createElement(I.a.Group,{controlId:"downloadableCheckbox",className:"custom-checkbox"},r.a.createElement(I.a.Check,{type:"checkbox",label:"Is Downloadable?",checked:ct,onChange:function(e){return lt(e.target.checked)},className:"custom-checkbox-input"})),r.a.createElement("div",{className:"d-flex align-items-end justify-content-end"},r.a.createElement(C.a,{variant:"primary",onClick:function(){e.saveMetadata({description:Ke,language:He,isDownloadable:ct,isCaption:rt,isPublic:et})},className:"btn-update-description mt-10-vh"},"Update Description")))),r.a.createElement(F.a,{eventKey:"annotations",title:"Annotations"},r.a.createElement("p",null,"Coming soon..."))))))),r.a.createElement(D.a,{xs:{span:12,order:3},sm:"audio"===yt()?{span:10,order:2,offset:1}:{span:9,order:2},md:"audio"===yt()?{span:10,order:2,offset:1}:{span:9,order:2},lg:"audio"===yt()?{span:8,order:2,offset:2}:{span:9,order:2},xl:"audio"===yt()?{span:8,order:2,offset:2}:{span:9,order:2}},0!==V.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{className:"editor-wrapper-container"},r.a.createElement(_.c,{editor:W,value:V,onChange:function(e){return Z(e)}},r.a.createElement(_.a,{readOnly:"boolean"===typeof e.isEditable&&!e.isEditable,renderElement:xt,renderLeaf:function(e){var t=e.attributes,a=e.children,n=e.leaf;return r.a.createElement("span",Object.assign({},t,{onDoubleClick:It},n.highlight&&{"data-cy":"search-highlighted"},{className:Object(j.a)(Xe(),n.bold&&"bold",n.highlight&&"#ffeeba"),"data-start":a.props.parent.start,"data-previous-timings":a.props.parent.previousTimings,title:a.props.parent.start}),a)},onKeyDown:function(t){if(Ne(!0),we){e.mediaRef&&e.mediaRef.current?e.mediaRef.current.pause():u&&u.current&&u.current.pauseVideo(),null!==ve&&clearTimeout(ve);var a=setTimeout((function(){e.mediaRef&&e.mediaRef.current?e.mediaRef.current.play():u&&u.current&&u.current.playVideo()}),1500);ge(a)}},onKeyUp:function(e){13===e.keyCode&&function(){for(var e=U.a.range(W,[]),t=W.children,a=function(a){if(t[a-1]&&"timedText"===t[a].type&&t[a].start===t[a-1].start&&t[a].startTimecode===t[a-1].startTimecode){var n,r=(t[a-1].children[0].text+t[a].children[0].text).split(" ").length,i=(((null===(n=t[a+1])||void 0===n?void 0:n.start)||t[a].start+.5*t[a].children[0].text.split(" ").length)-t[a].start)/r,o=t[a-1].start+i*t[a-1].children[0].text.split(" ").length,s=q(o);U.h.setNodes(W,{type:"timedText",start:o,startTimecode:s},{at:e,match:function(e){return"timedText"===e.type&&e.start===t[a].start&&e.startTimecode===t[a].startTimecode&&e.children[0].text===t[a].children[0].text}})}},n=0;n<t.length;n++)a(n)}()},decorate:kt})))):r.a.createElement("section",{className:"text-center"},r.a.createElement("i",{className:"text-center"},"Loading...")))))}Qe.defaultProps={showTitle:!1,showTimecodes:!0,showSpeakers:!0,mediaType:"digitalpaperedit",isEditable:!0};var et=t.default=Qe;o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[114,1,2]]]);
//# sourceMappingURL=main.9a82cec3.chunk.js.map